<template>
  <div class="channel-list-container">
    <div class="channel-list">
      <div
        class="d-flex align-items-center justify-content-center flex-column"
        style="height: 100%;"
        v-if="channels.length === 0"
      >
        <svg
          width="75"
          height="75"
          viewBox="0 0 75 75"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="mb-2"
        >
          <g clip-path="url(#clip0)">
            <path
              d="M74.925 20.424C74.5256 18.0141 72.4399 16.248 69.9972 16.2512C67.8924 16.2575 66.018 17.5842 65.3123 19.5672L49.985 18.1734C49.9235 17.3505 49.7256 16.5435 49.3993 15.7854L60.3902 8.67626C62.4267 10.5235 65.5751 10.37 67.4223 8.33342C69.2695 6.29683 69.116 3.1485 67.0794 1.30128C65.0429 -0.545937 61.8945 -0.39247 60.0473 1.64412C59.2116 2.56555 58.751 3.76658 58.7565 5.01055C58.7632 5.54417 58.8564 6.07311 59.0325 6.57675L48.0416 13.6958C45.2574 10.6459 40.5277 10.4304 37.4777 13.2147C36.6831 13.9402 36.0544 14.8285 35.6344 15.8191L22.4416 12.6455C23.2168 6.48605 18.8519 0.8643 12.6925 0.0891617C6.53293 -0.685977 0.91134 3.67884 0.136201 9.83827C-0.638938 15.9977 3.72588 21.6194 9.88531 22.3946C10.2242 22.4372 10.5647 22.4644 10.9062 22.4761L11.9828 36.4645C7.97064 37.4604 5.52548 41.5201 6.52122 45.5323C7.03314 47.5946 8.39748 49.3422 10.2742 50.3392L5.38825 64.9946C5.2746 64.9871 5.16719 64.9608 5.05103 64.9608C2.2788 64.9477 0.020984 67.1845 0.00786987 69.9567C-0.00524425 72.7289 2.23149 74.9868 5.00373 74.9999C7.77596 75.013 10.0338 72.7762 10.0469 70.004C10.0549 68.2964 9.19432 66.7019 7.76253 65.7714L12.6447 51.1248C13.4052 51.2547 14.1824 51.2547 14.9428 51.1248L19.8263 65.7714C17.5224 67.2758 16.8744 70.3631 18.3787 72.667C19.8831 74.9708 22.9704 75.6189 25.2743 74.1145C27.5781 72.6101 28.2262 69.5228 26.7218 67.219C25.7991 65.8061 24.224 64.9562 22.5365 64.9608C22.4204 64.9608 22.313 64.9871 22.1993 64.9946L17.3134 50.3405C20.9635 48.3896 22.3408 43.8491 20.3899 40.199C19.2027 37.9781 16.9796 36.5018 14.472 36.2696L13.3979 22.2925C17.2906 21.5417 20.5023 18.8002 21.8546 15.0735L35.0524 18.2408C35.0399 18.4094 35.0262 18.5781 35.0262 18.7492C35.0451 22.8878 38.4156 26.2275 42.5542 26.2086C45.9304 26.1931 48.8794 23.9217 49.7565 20.6613L65.0825 22.0552C65.5329 24.7731 68.1014 26.6112 70.8193 26.1608C73.5372 25.7104 75.3754 23.1419 74.925 20.424ZM63.7524 2.51262C65.132 2.51262 66.2503 3.63091 66.2503 5.01055C66.2503 6.39019 65.132 7.50848 63.7524 7.50848C62.3727 7.50848 61.2544 6.39019 61.2544 5.01055C61.2544 3.63091 62.3727 2.51262 63.7524 2.51262ZM5.05103 72.4546C3.6714 72.4546 2.5531 71.3363 2.5531 69.9567C2.5531 68.5771 3.6714 67.4588 5.05103 67.4588C6.43067 67.4588 7.54896 68.5771 7.54896 69.9567C7.54896 71.3363 6.43067 72.4546 5.05103 72.4546ZM22.5365 67.4588C23.9162 67.4588 25.0345 68.5771 25.0345 69.9567C25.0345 71.3363 23.9162 72.4546 22.5365 72.4546C21.1569 72.4546 20.0386 71.3363 20.0386 69.9567C20.0386 68.5771 21.1569 67.4588 22.5365 67.4588ZM13.7938 38.7326C16.5529 38.7326 18.7896 40.9693 18.7896 43.7284C18.7896 46.4876 16.5529 48.7243 13.7938 48.7243C11.0347 48.7243 8.79793 46.4876 8.79793 43.7284C8.79793 40.9693 11.0347 38.7326 13.7938 38.7326ZM11.2959 19.9981C6.46736 19.9981 2.5531 16.0839 2.5531 11.2554C2.5531 6.42688 6.46736 2.51262 11.2959 2.51262C16.1244 2.51262 20.0386 6.42688 20.0386 11.2554C20.0331 16.0815 16.122 19.9927 11.2959 19.9981ZM42.52 23.745C39.7609 23.745 37.5241 21.5083 37.5241 18.7492C37.5241 15.99 39.7609 13.7533 42.52 13.7533C45.2791 13.7533 47.5158 15.99 47.5158 18.7492C47.5158 21.5083 45.2791 23.745 42.52 23.745ZM69.9972 23.745C68.6176 23.745 67.4993 22.6267 67.4993 21.2471C67.4993 19.8674 68.6176 18.7492 69.9972 18.7492C71.3768 18.7492 72.4951 19.8674 72.4951 21.2471C72.4951 22.6267 71.3768 23.745 69.9972 23.745Z"
              fill="#C3C6D1"
            />
            <path
              d="M65.3556 52.586C64.8245 52.5095 64.2884 52.4711 63.7518 52.4713C59.1024 52.4789 54.9366 55.3462 53.2693 59.6865L42.4857 56.8739C42.5057 56.6565 42.5194 56.4392 42.5194 56.2181C42.5208 54.4655 41.9049 52.7684 40.7796 51.4246L47.8275 43.2027C48.5059 43.5441 49.2538 43.724 50.0132 43.7285C52.7854 43.7415 55.0433 41.5046 55.0562 38.7323C55.0692 35.9601 52.8323 33.7023 50.06 33.6893C47.2878 33.6764 45.03 35.9133 45.017 38.6855C45.0122 39.7224 45.3287 40.7354 45.9229 41.5853L38.8799 49.8035C37.7179 49.0983 36.3848 48.725 35.0256 48.7244C34.9007 48.7244 34.7758 48.7368 34.651 48.7431L32.2992 38.1656C34.7445 36.907 35.7065 33.9045 34.4478 31.4591C33.1892 29.0138 30.1867 28.0518 27.7414 29.3105C25.2961 30.5691 24.334 33.5716 25.5927 36.0169C26.4203 37.625 28.0547 38.6579 29.8624 38.7152L32.2105 49.2801C28.3737 50.832 26.5214 55.2004 28.0733 59.0371C29.6251 62.8739 33.9935 64.7261 37.8302 63.1743C39.6248 62.4484 41.0689 61.0562 41.8598 59.2893L52.6359 62.1033C51.7516 68.2438 56.0126 73.9386 62.1531 74.8229C68.2937 75.7071 73.9885 71.4461 74.8728 65.3056C75.7573 59.1651 71.4963 53.4703 65.3556 52.586ZM50.0132 36.2347C51.3929 36.2347 52.5111 37.353 52.5111 38.7326C52.5111 40.1123 51.3929 41.2306 50.0132 41.2306C48.6336 41.2306 47.5153 40.1123 47.5153 38.7326C47.5153 37.353 48.6336 36.2347 50.0132 36.2347ZM30.0298 36.2347C28.6501 36.2347 27.5319 35.1164 27.5319 33.7368C27.5319 32.3571 28.6501 31.2389 30.0298 31.2389C31.4094 31.2389 32.5277 32.3571 32.5277 33.7368C32.5277 35.1164 31.4094 36.2347 30.0298 36.2347ZM35.0256 61.214C32.2665 61.214 30.0298 58.9773 30.0298 56.2181C30.0298 53.459 32.2665 51.2223 35.0256 51.2223C37.7848 51.2223 40.0215 53.459 40.0215 56.2181C40.0215 58.9773 37.7848 61.214 35.0256 61.214ZM63.7518 72.4547C58.9233 72.4547 55.0091 68.5404 55.0091 63.7119C55.0091 58.8834 58.9233 54.9692 63.7518 54.9692C68.5803 54.9692 72.4946 58.8834 72.4946 63.7119C72.4891 68.5381 68.578 72.4492 63.7518 72.4547Z"
              fill="#C3C6D1"
            />
          </g>
          <defs>
            <clipPath id="clip0">
              <rect width="75" height="75" fill="white" />
            </clipPath>
          </defs>
        </svg>
        <p class="text-muted w-75 text-center mt-2">
          Your Lightning node starts with zero channels, and you must fund
          channels with other nodes on the network in order to send Lightning
          payments. Connecting to nodes that are already well-connected helps
          ensure that you will be able to find routes and send payments anywhere
          on the network.
        </p>
      </div>

      <div
        class="d-flex align-items-center justify-content-center"
        style="height: 100%;"
        v-else-if="channels[0]['type'] === 'loading'"
      >
        <b-spinner class="mb-4" variant="dark"></b-spinner>
      </div>

      <transition-group name="list" appear v-else>
        <div
          v-for="(channel, index) in channels"
          :key="index"
          @click="$emit('selectchannel', channel)"
        >
          <channel :channel="channel"></channel>
        </div>
      </transition-group>
    </div>
  </div>
</template>

<script>
import Channel from "@/components/Channels/Channel";
export default {
  props: {},
  computed: {
    channels() {
      return this.$store.state.lightning.channels;
    }
  },
  data() {
    return {
      state: {}
    };
  },
  methods: {},
  components: {
    Channel
  }
};
</script>

<style lang="scss" scoped>
.channel-list-container {
  overflow: hidden;
  position: relative;

  //bottom fade
  &:before {
    //nice faded white so the discarded blocks don't abruptly cut off
    content: "";
    position: absolute;
    height: 2rem;
    width: 100%;
    bottom: 0;
    left: 0;
    z-index: 2;
    background-image: linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0),
      rgba(255, 255, 255, 1)
    );
    border-bottom-left-radius: 1rem;
    border-bottom-right-radius: 1rem;
  }

  //top fade
  &:after {
    //nice faded white so the discarded blocks don't abruptly cut off
    content: "";
    position: absolute;
    height: 2rem;
    width: 100%;
    top: 0;
    left: 0;
    z-index: 2;
    background-image: linear-gradient(
      to top,
      rgba(255, 255, 255, 0),
      rgba(255, 255, 255, 1)
    );
  }
}
.channel-list {
  height: 23rem; //to do: change to max-height
  overflow-y: scroll;
  -webkit-overflow-scrolling: touch; //momentum scroll on iOS
}

//list transitions

.list-enter-active,
.list-leave-active {
  transition: transform 0.8s, opacity 0.8s ease;
}
.list-enter {
  transform: translate3d(0, 10px, 0);
  opacity: 0;
}
.list-enter-to {
  transform: translate3d(0, 0, 0);
  opacity: 1;
}
.list-leave {
  transform: translate3d(0, 0, 0);
  opacity: 1;
}
.list-leave-to {
  transform: translate3d(0, 10px, 0);
  opacity: 0;
}
</style>
